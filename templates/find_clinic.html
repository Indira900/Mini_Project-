{% extends "base.html" %}

{% block head %}
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Leaflet CSS for Maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhseINkfSgoIHPqNkRHE2pRESqmAudayI1AI=" crossorigin=""/>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.style.css') }}">
{% endblock %}

{% block title %}Find a Clinic - IVF Journey Tracker{% endblock %}

{% block content %}
<div class="container py-5">
  <h2 class="mb-4 text-center text-success">
    <i class="fas fa-hospital"></i> Find IVF Clinics
  </h2>

  <form method="POST" action="{{ url_for('find_clinic') }}" class="mb-4">
    <div class="input-group">
      <input type="text" class="form-control" name="location"
             placeholder="Enter city or state (e.g., Mumbai, Karnataka)">
      <button class="btn btn-success" type="submit">Search</button>
    </div>
    <small class="text-muted">You can search by city, state, or clinic name.</small>
  </form>

  {% if query %}
    <h5 class="mt-4">Search Results for "<strong>{{ query }}</strong>"</h5>

    {% if clinics %}
      <div class="row mt-3">
        {% for clinic in clinics %}
          <div class="col-md-6 mb-4">
            <div class="card shadow-sm h-100">
              <div class="card-body d-flex flex-column">
                <h6 class="card-title fw-bold text-success">
                  <i class="fas fa-hospital me-2"></i>{{ clinic.name }}
                </h6>
                <p class="card-text mb-2">
                  <i class="fas fa-map-marker-alt text-danger me-2"></i>
                  {{ clinic.address }}, {{ clinic.city }}, {{ clinic.state }}
                </p>
                {% if clinic.phone %}
                  <p class="card-text mb-2">
                    <i class="fas fa-phone text-success me-2"></i>{{ clinic.phone }}
                  </p>
                {% endif %}
                {% if clinic.contact_number %}
                  <p class="card-text mb-2">
                    <i class="fas fa-mobile-alt text-success me-2"></i>{{ clinic.contact_number }}
                  </p>
                {% endif %}
                {% if clinic.description %}
                  <p class="card-text text-muted small mb-3">{{ clinic.description[:100] }}...</p>
                {% endif %}
                <div class="mt-auto">
                  <a href="{{ url_for('clinic_detail', clinic_id=clinic.id) }}" class="btn btn-success btn-sm">
                    <i class="fas fa-info-circle me-2"></i>View Details
                  </a>
                  {% if clinic.website %}
                    <a href="{{ clinic.website }}" target="_blank" class="btn btn-outline-primary btn-sm ms-2">
                      <i class="fas fa-external-link-alt me-2"></i>Website
                    </a>
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-danger mt-3">
        No clinics found matching your search criteria. Please try another location.
      </p>
    {% endif %}
  {% endif %}
</div>
{% endblock %}
